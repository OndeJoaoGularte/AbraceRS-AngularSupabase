<section class="abrace-intro text-center">
  <div class="container">
    <h1 class="abrace-title">Junte-se a Nós</h1>
    <p class="lead text-muted">Seja um associado e faça parte da força que reconstrói o Rio Grande do Sul.</p>
  </div>
</section>

<section class="abrace-sectionw">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8">

        @if (submittedSuccessfully === null) {
          <div class="card shadow-sm">
            <div class="card-body p-4 p-md-5">
              <form [formGroup]="membershipForm" (ngSubmit)="onSubmit()" novalidate>
                <div class="mb-4">
                  <label class="form-label fw-bold">Quero me associar como:</label>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" id="pf" value="PESSOA_FISICA" formControlName="submission_type">
                    <label class="form-check-label" for="pf">Pessoa Física</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" id="pj" value="PESSOA_JURIDICA" formControlName="submission_type">
                    <label class="form-check-label" for="pj">Pessoa Jurídica (Empresa)</label>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="name" class="form-label">{{ membershipForm.get('submission_type')?.value === 'PESSOA_FISICA' ? 'Nome Completo' : 'Razão Social' }}</label>
                  <input type="text" id="name" class="form-control" formControlName="name">
                  @if(isInvalid('name')) { <div class="text-danger small mt-1">O nome é obrigatório.</div> }
                </div>

                @if (membershipForm.get('submission_type')?.value === 'PESSOA_JURIDICA') {
                  <div class="mb-3">
                    <label for="contact_person" class="form-label">Nome do Contato na Empresa</label>
                    <input type="text" id="contact_person" class="form-control" formControlName="contact_person">
                    @if(isInvalid('contact_person')) { <div class="text-danger small mt-1">O nome do contato é obrigatório.</div> }
                  </div>
                }

                <div class="mb-3">
                  <label for="document" class="form-label">{{ membershipForm.get('submission_type')?.value === 'PESSOA_FISICA' ? 'CPF' : 'CNPJ' }} (Opcional)</label>
                  <input type="text" id="document" class="form-control" formControlName="document">
                </div>
                
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="email" class="form-label">E-mail</label>
                    <input type="email" id="email" class="form-control" formControlName="email">
                    @if(isInvalid('email')) { <div class="text-danger small mt-1">Por favor, insira um e-mail válido.</div> }
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="phone" class="form-label">Telefone / WhatsApp</label>
                    <input type="tel" id="phone" class="form-control" formControlName="phone">
                    @if(isInvalid('phone')) { <div class="text-danger small mt-1">O telefone é obrigatório.</div> }
                  </div>
                </div>

                <div class="mb-4">
                  <label for="how_to_help" class="form-label">De que forma você ou sua empresa gostariam de ajudar?</label>
                  <textarea id="how_to_help" class="form-control" formControlName="how_to_help" rows="4" placeholder="Ex: Doações, voluntariado, divulgação, etc..."></textarea>
                </div>

                <div class="d-grid">
                  <button type="submit" class="btn btn-primary btn-lg" [disabled]="isSubmitting">
                    @if (isSubmitting) {
                      <span class="spinner-border spinner-border-sm"></span>
                      <span>Enviando...</span>
                    } @else {
                      <span>Enviar Cadastro</span>
                    }
                  </button>
                </div>
              </form>
            </div>
          </div>
        } @else if (submittedSuccessfully) {
          <div class="text-center p-5">
            <div class="abrace-icon mb-3"><i class="fas fa-check-circle text-success"></i></div>
            <h3 class="abrace-title">Obrigado!</h3>
            <p class="lead">Seu formulário de associação foi enviado com sucesso. Entraremos em contato em breve!</p>
            <a routerLink="/" class="btn btn-outline-primary mt-3">Voltar para a Home</a>
          </div>
        } @else {
          <div class="text-center p-5">
            <div class="abrace-icon mb-3"><i class="fas fa-times-circle text-danger"></i></div>
            <h3 class="abrace-title">Algo deu errado...</h3>
            <p class="lead">Não foi possível enviar seu formulário. Por favor, tente novamente mais tarde ou entre em contato por outro canal.</p>
            <a routerLink="/" class="btn btn-outline-primary mt-3">Voltar para a Home</a>
          </div>
        }

      </div>
    </div>
  </div>
</section>